<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YÄ±lmaz Karabulut Oyun</title>
<style>
body { margin:0;font-family:Arial,sans-serif;background:#000;color:#fff;text-align:center; }
h1,h2{ color:#0d6efd;margin:5px; }
#name-screen,#game-overlay { position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column; background:#000; z-index:500; }
#game-overlay { background:rgba(0,0,0,0.85); font-size:2em; display:none; }
input,button { padding:10px;margin:5px;border-radius:5px;border:none; }
#game-area { position:relative;width:90%;max-width:400px;height:400px;background:#111;margin:20px auto;overflow:hidden;border:2px solid #0d6efd;border-radius:10px; }
#player { position:absolute; bottom:10px; left:175px;width:50px;height:50px;border-radius:50%; display:flex;justify-content:center;align-items:center; font-size:24px; transition:left 0.05s; background:lime; }
.falling { position:absolute;top:0;width:30px;height:30px;border-radius:50%; }
.coin{background:gold;} .enemy{background:red;} .bonus{background:cyan;} .heart{background:red;}
.health-bar { width:90%;max-width:400px;background:#555;height:20px;border-radius:10px;margin:10px auto; }
.health-inner { width:100%;height:100%;background:lime;transition:width 0.3s; }
#mobile-controls { display:flex;justify-content:center;gap:20px;margin-top:10px; }
.mobile-btn { width:60px;height:60px;font-size:24px;border-radius:50%;background:#0d6efd;color:#fff;cursor:pointer; border:none;}
</style>
</head>
<body>
<div id="name-screen">
<h1>YILMAZK OYUN</h1>
<h2>Ä°sminizi Girin</h2>
<input type="text" id="player-name-input" placeholder="Ä°sim">
<button id="save-name-btn">BaÅŸla</button>
</div>

<div id="player-info"></div>

<div id="game-area">
<div id="player"></div>
<div id="game-overlay">
<div id="overlay-message">Kaybettiniz ðŸ˜¢</div>
<button id="restart-btn">Yeniden BaÅŸlat</button>
</div>
</div>

<div class="health-bar"><div id="health-inner"></div></div>
<p>Puan: <span id="score-display">0</span> | Para: <span id="money-display">100</span> | Zaman: <span id="time-display">0</span>s</p>

<div id="mobile-controls">
<button id="left-btn" class="mobile-btn">â—€</button>
<button id="right-btn" class="mobile-btn">â–¶</button>
</div>

<h3>Global Skor Tablosu</h3>
<table id="global-table" border="1" style="margin:auto;color:#fff;width:90%;max-width:400px;border-collapse:collapse;">
<tr><th>SÄ±ra</th><th>Ä°sim</th><th>Skor</th></tr>
</table>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
const firebaseConfig = { apiKey:"BURAYA", authDomain:"BURAYA", databaseURL:"BURAYA", projectId:"BURAYA", storageBucket:"BURAYA", messagingSenderId:"BURAYA", appId:"BURAYA" };
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

const nameScreen=document.getElementById('name-screen');
const playerNameInput=document.getElementById('player-name-input');
const saveBtn=document.getElementById('save-name-btn');
const restartBtn=document.getElementById('restart-btn');
const player=document.getElementById('player');
const playerInfo=document.getElementById('player-info');
const overlay=document.getElementById('game-overlay');
const overlayMsg=document.getElementById('overlay-message');
const gameArea=document.getElementById('game-area');
const scoreDisplay=document.getElementById('score-display');
const moneyDisplay=document.getElementById('money-display');
const timeDisplay=document.getElementById('time-display');
const healthInner=document.getElementById('health-inner');
const globalTable=document.getElementById('global-table');

let score=0,money=100,time=0,health=100,gameActive=false,playerPos=175,keys={},fallingObjects=[];

saveBtn.onclick=()=>{
window.playerName = playerNameInput.value||"Oyuncu";
nameScreen.style.display="none";
playerInfo.innerHTML=`<strong>${window.playerName}</strong>`;
startGame();
}

restartBtn.onclick=()=>{overlay.style.display="none";startGame();}

document.addEventListener('keydown',e=>{keys[e.key.toLowerCase()]=true;});
document.addEventListener('keyup',e=>{keys[e.key.toLowerCase()]=false;});
document.getElementById('left-btn').addEventListener('touchstart',()=>keys['a']=true);
document.getElementById('left-btn').addEventListener('touchend',()=>keys['a']=false);
document.getElementById('right-btn').addEventListener('touchstart',()=>keys['d']=true);
document.getElementById('right-btn').addEventListener('touchend',()=>keys['d']=false);

function spawnObject(){
const obj=document.createElement('div'); obj.classList.add('falling');
obj.style.left=Math.random()*370+'px';
obj.style.top='0px';
let r=Math.random();
if(r<0.55)obj.classList.add('coin');
else if(r<0.85)obj.classList.add('enemy');
else if(r<0.95)obj.classList.add('bonus');
else obj.classList.add('heart');
gameArea.appendChild(obj);fallingObjects.push(obj);
}

function startGame(){
score=0;time=0;health=100;gameActive=true;playerPos=175;
player.style.left=playerPos+'px';
scoreDisplay.textContent=score; moneyDisplay.textContent=money; timeDisplay.textContent=time;
healthInner.style.width='100%';
fallingObjects.forEach(o=>o.remove());fallingObjects=[];
requestAnimationFrame(gameLoop);
}

function gameLoop(){
if(!gameActive)return;
time++;timeDisplay.textContent=time;
if(keys['a'] && playerPos>0) playerPos-=5;
if(keys['d'] && playerPos<350) playerPos+=5;
player.style.left=playerPos+'px';
if(Math.random()<0.02) spawnObject();

for(let i=fallingObjects.length-1;i>=0;i--){
let obj=fallingObjects[i];
obj.style.top=parseInt(obj.style.top)+2+'px';
let objLeft=parseInt(obj.style.left),objTop=parseInt(obj.style.top);
if(objTop+30>=350 && objLeft+30>playerPos && objLeft<playerPos+50){
if(obj.classList.contains('coin'))score+=10;
else if(obj.classList.contains('enemy'))health-=20;
else if(obj.classList.contains('bonus'))score+=20;
else if(obj.classList.contains('heart'))health=Math.min(100,health+20);
obj.remove();fallingObjects.splice(i,1);}
else if(objTop>400){obj.remove();fallingObjects.splice(i,1);}
}

scoreDisplay.textContent=score;
healthInner.style.width=health+'%';

if(health<=0){
gameActive=false;
overlayMsg.textContent="Kaybettiniz ðŸ˜¢";
overlay.style.display="flex";
updateGlobalScore();
}

if(gameActive) requestAnimationFrame(gameLoop);
}

function updateGlobalScore(){
db.ref('scores/'+window.playerName).set(score);
db.ref('scores').orderByValue().limitToLast(10).once('value',snapshot=>{
let html='<tr><th>SÄ±ra</th><th>Ä°sim</th><th>Skor</th></tr>';
let arr=[]; snapshot.forEach(child=>arr.push({name:child.key,score:child.val()}));
arr.sort((a,b)=>b.score-b.score);
arr.forEach((item,i)=>html+=`<tr><td>${i+1}</td><td>${item.name}</td><td>${item.score}</td></tr>`);
globalTable.innerHTML=html;
});
}
</script>
</body>
</html>
