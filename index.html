<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YÄ±lmaz Karabulut Oyun</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#000; color:#fff; text-align:center; overflow-x:hidden; }
h1,h2,h3 { color:#0d6efd; margin:5px; }
#name-screen { position:fixed; top:0; left:0; width:100%; height:100%; background:#000; display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:500; }
#name-screen input { padding:10px; font-size:16px; margin-top:10px; border-radius:5px; border:none; }
#name-screen button { margin-top:10px; padding:10px 20px; background:#0d6efd; color:#fff; border:none; border-radius:5px; cursor:pointer; font-weight:bold; }
#game-area { position:relative; width:90%; max-width:400px; height:400px; background:#111; border:2px solid #0d6efd; margin:20px auto; overflow:hidden; border-radius:10px; }
#player { position:absolute; bottom:10px; left:175px; width:50px; height:50px; border-radius:50%; transition:left 0.05s linear; display:flex; justify-content:center; align-items:center; font-size:24px; }
.falling { position:absolute; top:0; width:30px; height:30px; border-radius:50%; }
.coin { background:gold; box-shadow:0 0 15px gold; }
.enemy { background:red; box-shadow:0 0 15px red; }
.bonus { background:cyan; box-shadow:0 0 15px cyan; }
.heart { background:red; border-radius:50%; width:30px; height:30px; box-shadow:0 0 10px pink; }
.health-bar { width:90%; max-width:400px; background:#555; height:20px; border-radius:10px; margin:10px auto; }
.health-inner { width:100%; height:100%; background:lime; transition:width 0.3s; }
#game-overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); color:#fff; display:flex; flex-direction:column; justify-content:center; align-items:center; font-size:2em; border-radius:10px; display:none; z-index:100; }
#mobile-controls { display:flex; justify-content:center; gap:20px; margin-top:10px; }
.mobile-btn { width:60px; height:60px; font-size:24px; border:none; border-radius:50%; background:#0d6efd; color:#fff; cursor:pointer; }
#shop { margin:20px auto; width:90%; max-width:400px; background:#222; padding:10px; border-radius:10px; display:flex; flex-wrap:wrap; justify-content:center; }
.shop-item { display:inline-block; margin:5px; padding:5px 10px; background:#0d6efd; border-radius:5px; cursor:pointer; }
#info { margin:20px; padding:10px; background:#111; border:1px solid #0d6efd; border-radius:10px; text-align:left; }
#global-table { margin:10px auto; width:90%; max-width:400px; border-collapse:collapse; }
#global-table th, #global-table td { border:1px solid #0d6efd; padding:5px; color:#fff; }
#player-info { margin:10px; padding:10px; border:1px solid #0d6efd; border-radius:10px; background:#111; }
.toggle-shop { margin-bottom:10px; cursor:pointer; color:#0d6efd; font-weight:bold; }
</style>
</head>
<body>

<div id="name-screen">
  <h1>YILMAZK OYUN</h1>
  <h2>Oyuncu Bilgilerini Girin</h2>
  <input type="text" id="player-name-input" placeholder="Ä°sim">
  <input type="text" id="player-age-input" placeholder="YaÅŸ">
  <input type="text" id="player-school-input" placeholder="Okul">
  <input type="text" id="player-city-input" placeholder="Åžehir">
  <input type="text" id="player-hobby-input" placeholder="Hobiler">
  <button id="save-name-btn">BaÅŸla</button>
</div>

<div id="player-info"></div>

<div id="game-area">
  <div id="player"></div>
  <div id="game-overlay">
    <div id="overlay-message">Kaybettiniz ðŸ˜¢</div>
    <button id="restart-btn">Yeniden BaÅŸlat</button>
  </div>
</div>

<div class="health-bar"><div id="health-inner"></div></div>
<p>Puan: <span id="score-display">0</span> | Para: <span id="money-display">100</span> | Zaman: <span id="time-display">0</span>s</p>

<div id="mobile-controls">
  <button id="left-btn" class="mobile-btn">â—€</button>
  <button id="right-btn" class="mobile-btn">â–¶</button>
</div>

<div class="toggle-shop">DÃ¼kkanÄ± GÃ¶ster/Gizle</div>
<div id="shop" style="display:none;">
  <div class="shop-item" data-cost="500" data-type="hat">Åžapka - 500</div>
  <div class="shop-item" data-cost="1000" data-type="outfit">Elbise - 1000</div>
  <div class="shop-item" data-cost="2000" data-type="face">YÃ¼z Ä°fadesi - 2000</div>
  <div class="shop-item" data-cost="500" data-type="color">Renk - 500</div>
</div>

<div id="info">
  <h3>Oyun Bilgisi</h3>
  <p>PC: A/D tuÅŸlarÄ±, Mobil: â—€ â–¶ tuÅŸlarÄ±</p>
  <p>AltÄ±n toplarÄ± topla, kÄ±rmÄ±zÄ± dÃ¼ÅŸmanlardan kaÃ§, bonuslarÄ± ve kalpleri yakala.</p>
</div>

<h3>Ä°letiÅŸim</h3>
<p>YardÄ±m iÃ§in: <a href="mailto:yilmazkarabulut@akhisarkoleji.com">yilmazkarabulut@akhisarkoleji.com</a></p>

<h3>Global Skor Tablosu</h3>
<table id="global-table">
<tr><th>SÄ±ra</th><th>Ä°sim</th><th>Skor</th></tr>
</table>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
document.addEventListener('DOMContentLoaded',()=>{

// Firebase config (sen kendi Firebase bilgilerini ekle)
const firebaseConfig = {
  apiKey: "BURAYA",
  authDomain: "BURAYA",
  databaseURL: "BURAYA",
  projectId: "BURAYA",
  storageBucket: "BURAYA",
  messagingSenderId: "BURAYA",
  appId: "BURAYA"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const nameScreen = document.getElementById('name-screen');
const playerNameInput = document.getElementById('player-name-input');
const playerAgeInput = document.getElementById('player-age-input');
const playerSchoolInput = document.getElementById('player-school-input');
const playerCityInput = document.getElementById('player-city-input');
const playerHobbyInput = document.getElementById('player-hobby-input');
const saveBtn = document.getElementById('save-name-btn');
const restartBtn = document.getElementById('restart-btn');
const playerInfo = document.getElementById('player-info');
const gameOverlay = document.getElementById('game-overlay');
const overlayMessage = document.getElementById('overlay-message');
const player = document.getElementById('player');
const gameArea = document.getElementById('game-area');
const scoreDisplay = document.getElementById('score-display');
const moneyDisplay = document.getElementById('money-display');
const timeDisplay = document.getElementById('time-display');
const healthInner = document.getElementById('health-inner');
const shop = document.getElementById('shop');
const shopItems = document.querySelectorAll('.shop-item');
const toggleShopBtn = document.querySelector('.toggle-shop');
const globalTable = document.getElementById('global-table');

let score=0, money=100, time=0, health=100, gameActive=false, playerPos=175, keys={}, selectedHat=null, selectedOutfit=null, selectedFace=null, selectedColor=null;
let fallingObjects=[];

// --- BaÅŸla butonu ---
saveBtn.addEventListener('click',()=>{
  window.playerName = playerNameInput.value || 'Oyuncu';
  window.playerAge = playerAgeInput.value || '';
  window.playerSchool = playerSchoolInput.value || '';
  window.playerCity = playerCityInput.value || '';
  window.playerHobby = playerHobbyInput.value || '';
  nameScreen.style.display='none';
  showPlayerInfo();
  startGame();
});

function showPlayerInfo(){
  playerInfo.innerHTML = `
    <strong>${window.playerName}</strong> | YaÅŸ: ${window.playerAge} | Okul: ${window.playerSchool} | Åžehir: ${window.playerCity} | Hobiler: ${window.playerHobby}
  `;
}

// --- Restart ---
restartBtn.addEventListener('click',()=>{ gameOverlay.style.display='none'; startGame(); });

// --- Mobil kontroller ---
document.getElementById('left-btn').addEventListener('touchstart',()=>{ keys['a']=true; });
document.getElementById('left-btn').addEventListener('touchend',()=>{ keys['a']=false; });
document.getElementById('right-btn').addEventListener('touchstart',()=>{ keys['d']=true; });
document.getElementById('right-btn').addEventListener('touchend',()=>{ keys['d']=false; });
document.addEventListener('keydown', e=>{ keys[e.key.toLowerCase()]=true; });
document.addEventListener('keyup', e=>{ keys[e.key.toLowerCase()]=false; });

// --- Shop ---
toggleShopBtn.addEventListener('click', ()=>{ shop.style.display = (shop.style.display==='none') ? 'flex':'none'; });
shopItems.forEach(item=>{
  item.addEventListener('click',()=>{
    const cost = parseInt(item.dataset.cost);
    const type = item.dataset.type;
    if(money >= cost){
      money -= cost;
      if(type==='hat') selectedHat='ðŸŽ©';
      if(type==='outfit') selectedOutfit='ðŸ‘•';
      if(type==='face') selectedFace='ðŸ˜Ž';
      if(type==='color') selectedColor='green';
      moneyDisplay.textContent = money;
      savePlayerData();
      updatePlayerAppearance();
    }
  });
});

function updatePlayerAppearance(){
  player.style.backgroundColor = selectedColor||'lime';
  player.textContent = (selectedHat||'') + (selectedOutfit||'') + (selectedFace||'');
}

// --- Player veri kaydÄ± ---
function savePlayerData(){
  db.ref('players/'+window.playerName).set({
    selectedHat, selectedOutfit, selectedFace, selectedColor, money
  });
}

// --- BaÅŸlat ---
function startGame(){
  score=0; time=0; health=100; gameActive=true; playerPos=175;
  player.style.left=playerPos+'px';
  updatePlayerAppearance();
  scoreDisplay.textContent=score; moneyDisplay.textContent=money; timeDisplay.textContent=time;
  healthInner.style.width='100%';
  fallingObjects.forEach(o=>o.remove()); fallingObjects=[];
  requestAnimationFrame(gameLoop);
}

// --- Objeler ---
function spawnObject(){
  const obj = document.createElement('div');
  obj.classList.add('falling');
  obj.style.left = Math.random()*370+'px';
  obj.style.top = '0px';
  const r = Math.random();
  if(r<0.55) obj.classList.add('coin');
  else if(r<0.85) obj.classList.add('enemy');
  else if(r<0.95) obj.classList.add('bonus');
  else obj.classList.add('heart');
  gameArea.appendChild(obj);
  fallingObjects.push(obj);
}

// --- Oyun dÃ¶ngÃ¼sÃ¼ ---
function gameLoop(){
  if(!gameActive) return;
  time++; timeDisplay.textContent=time;

  if(keys['a'] && playerPos>0) playerPos-=5;
  if(keys['d'] && playerPos<350) playerPos+=5;
  player.style.left=playerPos+'px';

  if(Math.random()<0.02) spawnObject();

  for(let i=fallingObjects.length-1;i>=0;i--){
    let obj=fallingObjects[i];
    obj.style.top=parseInt(obj.style.top)+2+'px';
    const objLeft=parseInt(obj.style.left), objTop=parseInt(obj.style.top);
    if(objTop+30>=350 && objLeft+30>playerPos && objLeft<playerPos+50){
      if(obj.classList.contains('coin')){ score+=10; }
      else if(obj.classList.contains('enemy')){ health-=20; }
      else if(obj.classList.contains('bonus')){ score+=20; }
      else if(obj.classList.contains('heart')){ health=Math.min(100, health+20); }
      obj.remove(); fallingObjects.splice(i,1);
    } else if(objTop>400){ obj.remove(); fallingObjects.splice(i,1); }
  }

  scoreDisplay.textContent=score;
  healthInner.style.width=health+'%';

  if(health<=0){ 
    gameActive=false; 
    overlayMessage.textContent='Kaybettiniz ðŸ˜¢'; 
    gameOverlay.style.display='flex'; 
    savePlayerData();
    updateGlobalScore();
  }

  if(gameActive) requestAnimationFrame(gameLoop);
}

// --- Global skor ---
function updateGlobalScore(){
  db.ref('scores/'+window.playerName).set(score);
  db.ref('scores').orderByValue().limitToLast(10).once('value', snapshot=>{
    let html='<tr><th>SÄ±ra</th><th>Ä°sim</th><th>Skor</th></tr>';
    let arr=[];
    snapshot.forEach(child=>{
      arr.push({name:child.key, score:child.val()});
    });
    arr.sort((a,b)=>b.score-a.score);
    arr.forEach((item,i)=>{
      html+='<tr><td>'+(i+1)+'</td><td>'+item.name+'</td><td>'+item.score+'</td></tr>';
    });
    globalTable.innerHTML = html;
  });
}

});
</script>
</body>
</html>
